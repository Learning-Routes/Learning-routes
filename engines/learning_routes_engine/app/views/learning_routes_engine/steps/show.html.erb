<% content_for(:title, "#{@step.localized_title} #{t('learning_engine.route.title_suffix')}") %>

<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
  <div class="flex gap-8">
    <!-- Main content area -->
    <div class="flex-1 max-w-3xl">
      <turbo-frame id="step_content_<%= @step.id %>">
        <% if @step.delivery_format == "audio" %>
          <%# Audio-based lesson: player + voice response + quiz %>
          <%= render "content_engine/audio/audio_lesson", step: @step, route: @route %>
        <% else %>
          <% case @step.content_type %>
          <% when "lesson" %>
            <%= render "lesson" %>
          <% when "exercise" %>
            <%= render "exercise" %>
          <% when "assessment" %>
            <%= render "assessment" %>
          <% when "review" %>
            <%= render "review" %>
          <% end %>
        <% end %>
      </turbo-frame>

      <!-- Navigation -->
      <%= render "navigation" %>
    </div>

    <!-- Sidebar -->
    <%= render "sidebar" %>
  </div>
</div>
