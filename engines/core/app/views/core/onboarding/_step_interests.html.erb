<%= turbo_frame_tag "onboarding_step" do %>
  <div data-controller="checkbox-group">
    <div class="text-center mb-8">
      <h2 class="text-2xl font-bold text-gray-900">What do you want to learn?</h2>
      <p class="mt-2 text-gray-600">Select one or more topics that interest you</p>
    </div>

    <%= form_with(url: core.onboarding_update_step_path(step: "interests"), method: :patch, data: { turbo_frame: "onboarding_step" }) do |f| %>
      <% if profile.errors.any? %>
        <div role="alert" class="mb-4 rounded-lg bg-red-50 border border-red-200 p-3">
          <% profile.errors.full_messages.each do |msg| %>
            <p class="text-sm text-red-600"><%= msg %></p>
          <% end %>
        </div>
      <% end %>

      <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 mb-6">
        <% [
          ["Programming", "code-bracket", "ðŸ’»"],
          ["Mathematics", "calculator", "ðŸ“"],
          ["Languages", "language", "ðŸŒ"],
          ["Sciences", "beaker", "ðŸ”¬"],
          ["Business", "briefcase", "ðŸ’¼"],
          ["Arts", "paint-brush", "ðŸŽ¨"]
        ].each do |name, _icon, emoji| %>
          <label class="relative cursor-pointer" data-checkbox-group-target="option">
            <input type="checkbox" name="interests[]" value="<%= name.downcase %>"
                   class="peer sr-only"
                   <%= "checked" if profile.interests&.include?(name.downcase) %>
                   data-action="change->checkbox-group#update">
            <div class="flex flex-col items-center justify-center rounded-xl border-2 border-gray-200 p-4 transition
                        peer-checked:border-indigo-600 peer-checked:bg-indigo-50
                        hover:border-gray-300 hover:bg-gray-50">
              <span class="text-2xl mb-2"><%= emoji %></span>
              <span class="text-sm font-medium text-gray-700"><%= name %></span>
            </div>
          </label>
        <% end %>
      </div>

      <div class="mb-6">
        <label for="custom_interest" class="block text-sm font-medium text-gray-700 mb-1">Or enter a custom topic</label>
        <input type="text" name="custom_interest" id="custom_interest"
               class="w-full rounded-lg border border-gray-300 px-4 py-3 text-gray-900 placeholder-gray-400 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 focus:outline-none transition"
               placeholder="e.g., Machine Learning, Guitar, Cooking..."
               data-action="input->checkbox-group#update">
      </div>

      <div class="flex justify-end">
        <%= f.submit "Continue â†’",
            class: "rounded-lg bg-indigo-600 px-8 py-3 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition cursor-pointer",
            data: { checkbox_group_target: "submit" } %>
      </div>
    <% end %>
  </div>
<% end %>
