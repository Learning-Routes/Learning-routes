<%= turbo_frame_tag "onboarding_step" do %>
  <div data-controller="selectable-card">
    <%# === Heading === %>
    <div style="text-align:center; margin-bottom:2rem;">
      <h2 style="font-family:'DM Sans',sans-serif; font-weight:600; font-size:1.5rem; color:#1C1812; letter-spacing:-0.5px; margin:0 0 0.5rem;">
        <em style="font-style:italic;">What's your current level?</em>
      </h2>
      <p style="font-family:'DM Sans',sans-serif; font-size:0.85rem; color:#6D665B; margin:0;">
        This helps us personalize the difficulty of your learning path.
      </p>
    </div>

    <%= form_with(url: core.onboarding_update_step_path(step: "level"), method: :patch, data: { turbo_frame: "onboarding_step" }) do |f| %>
      <%# === Level options === %>
      <div style="display:flex; flex-direction:column; gap:0.6rem; margin-bottom:2rem;">
        <% [
          ["beginner", "Beginner", "I'm just starting out â€” teach me from scratch", "ðŸŒ±"],
          ["intermediate", "Intermediate", "I have some experience and want to go deeper", "ðŸŒ¿"],
          ["advanced", "Advanced", "I want to master this topic at an expert level", "ðŸŒ³"]
        ].each do |value, label, description, emoji| %>
          <label style="cursor:pointer; display:block;" data-selectable-card-target="card">
            <input type="radio" name="current_level" value="<%= value %>"
                   style="position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;"
                   <%= "checked" if profile.current_level == value %>
                   data-action="change->selectable-card#toggle">
            <div data-card-visual
                 style="display:flex; align-items:center; padding:1rem 1.1rem; border-radius:12px; border:1.5px solid rgba(28,24,18,0.08); background:#FEFDFB; transition:all 0.2s ease;"
                 onmouseenter="this.style.boxShadow='0 2px 8px rgba(28,24,18,0.04)'"
                 onmouseleave="this.style.boxShadow='none'">
              <span style="font-size:1.6rem; margin-right:0.9rem; flex-shrink:0;"><%= emoji %></span>
              <div>
                <span style="font-family:'DM Sans',sans-serif; font-weight:600; font-size:0.88rem; color:#1C1812; display:block; letter-spacing:-0.2px;"><%= label %></span>
                <span style="font-family:'DM Sans',sans-serif; font-size:0.75rem; color:#A09889; display:block; margin-top:0.15rem;"><%= description %></span>
              </div>
            </div>
          </label>
        <% end %>
      </div>

      <%# === Navigation buttons === %>
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <%= link_to "â† Back", core.onboarding_path(step: "interests"),
            style: "font-family:'DM Sans',sans-serif; font-weight:500; font-size:0.82rem; color:#6D665B; text-decoration:none; padding:0.65rem 1.2rem; border-radius:11px; border:1px solid rgba(28,24,18,0.08); transition:all 0.2s ease; display:inline-flex; align-items:center;",
            onmouseenter: "this.style.borderColor='rgba(28,24,18,0.15)';this.style.color='#1C1812'",
            onmouseleave: "this.style.borderColor='rgba(28,24,18,0.08)';this.style.color='#6D665B'",
            data: { turbo_frame: "onboarding_step" } %>
        <%= f.submit "Continue â†’",
            style: "font-family:'DM Sans',sans-serif; font-weight:600; font-size:0.82rem; color:#F5F1EB; background:#2C261E; border:none; border-radius:11px; padding:0.65rem 1.6rem; cursor:pointer; transition:all 0.2s ease; box-shadow:0 1px 3px rgba(28,24,18,0.12),0 1px 2px rgba(28,24,18,0.06); letter-spacing:-0.2px;",
            onmouseenter: "this.style.boxShadow='0 4px 16px rgba(28,24,18,0.18)';this.style.transform='translateY(-1px)'",
            onmouseleave: "this.style.boxShadow='0 1px 3px rgba(28,24,18,0.12),0 1px 2px rgba(28,24,18,0.06)';this.style.transform='translateY(0)'" %>
      </div>
    <% end %>
  </div>
<% end %>
