<%# Evaluation Result (Turbo Stream replacement)
     locals: voice_response (VoiceResponse) %>

<div id="voice-evaluation-<%= voice_response.id %>"
     class="rounded-xl bg-gray-800/50 border border-white/[0.06] p-5">

  <p class="text-xs font-medium text-gray-400 uppercase tracking-wider mb-4" style="font-family: 'DM Mono', monospace;">
    <%= t("voice_evaluation.result_label") %>
  </p>

  <!-- Score Circle -->
  <div class="text-center mb-5">
    <% score_color = voice_response.score.to_i >= 70 ? "text-green-400" : voice_response.score.to_i >= 50 ? "text-yellow-400" : "text-red-400" %>
    <div class="inline-flex items-center justify-center w-20 h-20 rounded-full border-2 <%= score_color.gsub('text-', 'border-') %>">
      <span class="text-2xl font-bold <%= score_color %>"><%= voice_response.score %></span>
    </div>
    <p class="text-xs text-gray-500 mt-2"><%= t("voice_evaluation.out_of_points") %></p>
  </div>

  <!-- Feedback -->
  <% if voice_response.feedback_text.present? %>
    <div class="rounded-lg bg-gray-900/50 p-4 mb-4">
      <p class="text-sm text-gray-300 leading-relaxed"><%= voice_response.feedback_text %></p>
    </div>
  <% end %>

  <!-- Strengths -->
  <% if voice_response.strengths.any? %>
    <div class="mb-3">
      <p class="text-xs font-medium text-green-400 mb-1.5"><%= t("voice_evaluation.strengths") %></p>
      <% voice_response.strengths.each do |s| %>
        <p class="text-sm text-gray-300 flex items-start gap-2 mb-1">
          <span class="text-green-400">+</span> <%= s %>
        </p>
      <% end %>
    </div>
  <% end %>

  <!-- Improvements -->
  <% if voice_response.improvements.any? %>
    <div class="mb-3">
      <p class="text-xs font-medium text-yellow-400 mb-1.5"><%= t("voice_evaluation.improvements") %></p>
      <% voice_response.improvements.each do |i| %>
        <p class="text-sm text-gray-300 flex items-start gap-2 mb-1">
          <span class="text-yellow-400">&rarr;</span> <%= i %>
        </p>
      <% end %>
    </div>
  <% end %>

  <!-- Transcript -->
  <% if voice_response.transcription.present? %>
    <details class="mt-4 rounded-lg bg-gray-900/50">
      <summary class="px-4 py-2 text-xs text-gray-500 cursor-pointer hover:text-gray-400">
        <%= t("voice_evaluation.your_transcript") %>
      </summary>
      <p class="px-4 pb-3 text-sm text-gray-400 italic">"<%= voice_response.transcription %>"</p>
    </details>
  <% end %>

  <!-- Understanding Level Badge -->
  <% if voice_response.ai_evaluation.dig("understanding_level").present? %>
    <% level = voice_response.ai_evaluation["understanding_level"] %>
    <% badge_classes = {
      "excellent" => "bg-green-500/10 text-green-400 border-green-500/20",
      "good" => "bg-blue-500/10 text-blue-400 border-blue-500/20",
      "developing" => "bg-yellow-500/10 text-yellow-400 border-yellow-500/20",
      "needs_review" => "bg-red-500/10 text-red-400 border-red-500/20"
    } %>
    <div class="mt-4 text-center">
      <span class="inline-block px-3 py-1 text-xs font-medium rounded-full border <%= badge_classes[level] || badge_classes["developing"] %>">
        <%= t("voice_evaluation.understanding.#{level}", default: level.humanize) %>
      </span>
    </div>
  <% end %>
</div>
