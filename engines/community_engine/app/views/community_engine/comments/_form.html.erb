<% parent_id = local_assigns[:parent_id] %>
<div id="comment_form_<%= commentable.class.name.parameterize %>_<%= commentable.id %><%= parent_id ? "_reply_#{parent_id}" : '' %>">
  <%= form_with url: community_engine.comments_path, method: :post do |f| %>
    <div id="comment_form_errors"></div>

    <%= f.hidden_field :commentable_type, value: commentable.class.name %>
    <%= f.hidden_field :commentable_id, value: commentable.id %>
    <% if parent_id %>
      <%= f.hidden_field :parent_id, value: parent_id %>
    <% end %>

    <textarea name="comment[body]"
              placeholder="<%= parent_id ? t('community_engine.comments.reply_placeholder') : t('community_engine.comments.placeholder') %>"
              required
              rows="3"
              style="width:100%; box-sizing:border-box; padding:0.7rem 0.9rem; border-radius:14px; border:1px solid var(--color-faint, rgba(28,24,18,0.08));
                     background:var(--color-bg, #F5F1EB); color:var(--color-txt, #1C1812); font-family:'DM Sans',sans-serif; font-size:0.82rem;
                     resize:none; outline:none; transition:border-color 0.2s; margin-bottom:0.5rem;"></textarea>

    <div style="display:flex; justify-content:flex-end;">
      <button type="submit"
              style="padding:0.5rem 1rem; border-radius:11px; border:none; background:var(--color-accent, #2C261E); color:var(--color-accent-text, #F5F1EB);
                     font-family:'DM Sans',sans-serif; font-size:0.82rem; font-weight:500; cursor:pointer; transition:opacity 0.15s;">
        <%= parent_id ? t("community_engine.comments.reply_btn") : t("community_engine.comments.submit_btn") %>
      </button>
    </div>
  <% end %>
</div>
