<%# Floating thought bubbles showing best comments from shared routes.
     Locals: thoughts (array of hashes: { comment:, route_topic:, author_name: }) %>
<% if thoughts.present? && thoughts.any? %>
<div data-controller="floating-thoughts"
     data-floating-thoughts-interval-value="5000"
     style="position:relative; min-height:90px; margin-bottom:1.5rem; overflow:hidden;">

  <%# Section label %>
  <p style="font-family:'DM Mono',monospace; font-size:0.6rem; text-transform:uppercase; letter-spacing:0.08em;
            color:var(--color-muted, #887F72); margin:0 0 0.75rem;">
    <%= t("community_engine.feed.floating_thoughts.title") %>
  </p>

  <% thoughts.each do |thought| %>
    <div data-floating-thoughts-target="thought"
         style="position:absolute; top:1.5rem; left:0; right:0; opacity:0; transform:translateY(12px);
                background:var(--color-card, rgba(255,255,255,0.6)); backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px);
                border:1px solid var(--color-faint, rgba(28,24,18,0.06)); border-radius:14px;
                padding:0.8rem 1rem; box-shadow:0 2px 12px rgba(0,0,0,0.04);">
      <%# Speech bubble arrow %>
      <div style="position:absolute; top:-6px; left:1.5rem; width:12px; height:12px; background:var(--color-card, rgba(255,255,255,0.6));
                  border-left:1px solid var(--color-faint, rgba(28,24,18,0.06)); border-top:1px solid var(--color-faint, rgba(28,24,18,0.06));
                  transform:rotate(45deg);"></div>

      <p style="font-family:'DM Sans',sans-serif; font-size:0.82rem; color:var(--color-sub, #6D665B);
               line-height:1.5; margin:0 0 0.4rem; font-style:italic;">
        "<%= thought[:comment].truncate(140) %>"
      </p>
      <div style="display:flex; align-items:center; gap:0.4rem;">
        <div style="width:18px; height:18px; border-radius:50%; background:var(--color-accent, #2C261E);
                    display:flex; align-items:center; justify-content:center; color:var(--color-accent-text, #F5F1EB);
                    font-family:'DM Sans',sans-serif; font-size:0.45rem; font-weight:700;">
          <%= thought[:author_name].to_s.first&.upcase || "?" %>
        </div>
        <span style="font-family:'DM Sans',sans-serif; font-size:0.68rem; font-weight:500; color:var(--color-txt, #1C1812);">
          <%= thought[:author_name] %>
        </span>
        <span style="font-family:'DM Mono',monospace; font-size:0.58rem; color:var(--color-muted, #887F72);">
          on <%= thought[:route_topic].to_s.truncate(40) %>
        </span>
      </div>
    </div>
  <% end %>
</div>
<% end %>
