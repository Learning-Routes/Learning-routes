<%# Single post card — compact feed style. Locals: post %>
<div id="post_<%= post.id %>" class="feed-card" style="background:var(--color-card, rgba(255,255,255,0.6)); backdrop-filter:blur(16px); -webkit-backdrop-filter:blur(16px);
            border:1px solid var(--color-faint, rgba(28,24,18,0.06)); border-radius:12px; padding:1rem 1.25rem; transition:box-shadow 0.15s;">
  <div style="display:flex; align-items:flex-start; gap:0.75rem;">
    <%# Avatar %>
    <div style="width:36px; height:36px; border-radius:50%; background:var(--color-accent, #2C261E);
                display:flex; align-items:center; justify-content:center; color:var(--color-accent-text, #F5F1EB);
                font-family:'DM Sans',sans-serif; font-size:0.72rem; font-weight:700; flex-shrink:0;">
      <%= post.user.name.to_s.first&.upcase || "?" %>
    </div>

    <div style="flex:1; min-width:0;">
      <%# Author + time + delete %>
      <div style="display:flex; align-items:center; gap:0.5rem; margin-bottom:0.25rem;">
        <span style="font-family:'DM Sans',sans-serif; font-size:0.85rem; font-weight:600; color:var(--color-txt, #1C1812);">
          <%= post.user.name %>
        </span>
        <span style="font-family:'DM Mono',monospace; font-size:0.68rem; color:var(--color-muted, #887F72);">
          <%= time_ago_in_words(post.created_at) %>
        </span>
        <% if post.owned_by?(current_user) %>
          <%= button_to community_engine.post_path(post), method: :delete,
                data: { turbo_confirm: t("community_engine.posts.delete_confirm") },
                style: "background:none; border:none; cursor:pointer; font-family:'DM Mono',monospace; font-size:0.62rem; color:var(--color-muted, #887F72); padding:0; margin-left:auto; opacity:0.6; transition:opacity 0.15s;" do %>
            <%= t("community_engine.posts.delete") %>
          <% end %>
        <% end %>
      </div>

      <%# Post body %>
      <p style="font-family:'DM Sans',sans-serif; font-size:0.88rem; color:var(--color-sub, #6D665B); line-height:1.6; margin:0; white-space:pre-wrap; word-break:break-word;">
        <%= post.body %>
      </p>

      <%# Inline floating thought — best comment preview %>
      <% best_comment = post.comments.order(created_at: :desc).includes(:user).first %>
      <% if best_comment %>
        <div style="display:inline-flex; align-items:center; gap:0.4rem; margin-top:0.5rem; padding:0.3rem 0.55rem;
                    background:var(--color-tint, rgba(28,24,18,0.03)); border-radius:8px; max-width:100%;">
          <div style="flex-shrink:0; width:20px; height:20px; border-radius:50%;
                      background:var(--color-accent, #2C261E); color:var(--color-accent-text, #F5F1EB);
                      display:flex; align-items:center; justify-content:center;
                      font-family:'DM Sans',sans-serif; font-size:0.45rem; font-weight:700;">
            <%= best_comment.user&.name.to_s.first&.upcase || "?" %>
          </div>
          <p style="font-family:'DM Sans',sans-serif; font-size:0.7rem; color:var(--color-muted, #887F72);
                   line-height:1.3; margin:0; font-style:italic;
                   overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
            "<%= best_comment.body.truncate(60) %>"
          </p>
        </div>
      <% end %>

      <%# Actions row %>
      <div style="display:flex; align-items:center; gap:1rem; margin-top:0.5rem;">
        <%= render "community_engine/likes/button",
              likeable: post,
              liked: post.liked_by?(current_user),
              likes_count: post.likes_count %>
        <span style="display:inline-flex; align-items:center; gap:0.25rem; font-family:'DM Mono',monospace; font-size:0.68rem; color:var(--color-muted, #887F72);">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
          <%= post.comments_count %>
        </span>
      </div>
    </div>
  </div>
</div>
