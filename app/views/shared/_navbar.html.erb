<nav data-controller="navbar" class="fixed top-0 left-0 right-0 z-[100]">
  <div data-navbar-target="bar"
       class="flex items-center justify-between h-[58px] px-[clamp(1.5rem,5vw,4rem)] border-b border-transparent transition-all duration-300">

    <%# === Logo === %>
    <%= link_to root_path, class: "flex items-center gap-[0.55rem] no-underline" do %>
      <%= render "shared/logo", size: 28 %>
      <span class="font-sans font-bold text-[0.92rem] tracking-[-0.5px] text-txt">Learning Routes</span>
    <% end %>

    <%# === Desktop links === %>
    <div class="hidden md:flex items-center gap-[clamp(1rem,3vw,2.5rem)]">
      <a href="#features" class="font-sans text-[0.8rem] font-medium text-muted hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors duration-200">
        <%= t("nav.features") %>
      </a>
      <a href="#how-it-works" class="font-sans text-[0.8rem] font-medium text-muted hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors duration-200">
        <%= t("nav.how_it_works") %>
      </a>

      <% if current_user %>
        <%= link_to t("nav.dashboard"), dashboard_path,
            class: "font-sans text-[0.8rem] font-medium text-muted hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors duration-200" %>
      <% else %>
        <%= link_to t("nav.sign_in"), core.sign_in_path,
            class: "font-sans text-[0.8rem] font-medium text-muted hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors duration-200" %>
      <% end %>

      <%= render "shared/locale_toggle" %>

      <% if current_user %>
        <%= link_to t("nav.profile"), profile_path,
            class: "inline-flex items-center justify-center font-sans text-[0.8rem] font-semibold
                    bg-accent text-accent-text px-[1.15rem] py-[0.48rem] rounded-btn btn-shadow
                    hover-lift tracking-[-0.2px]" %>
      <% else %>
        <%= link_to t("nav.sign_up"), core.sign_up_path,
            class: "inline-flex items-center justify-center font-sans text-[0.8rem] font-semibold
                    bg-accent text-accent-text px-[1.15rem] py-[0.48rem] rounded-btn btn-shadow
                    hover-lift tracking-[-0.2px]" %>
      <% end %>
    </div>

    <%# === Mobile hamburger === %>
    <button data-action="navbar#toggleMenu" data-navbar-target="menuBtn" class="md:hidden p-2 -mr-2 text-txt" aria-label="Menu" aria-expanded="false" aria-controls="navbar-mobile-menu">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" aria-hidden="true">
        <path d="M3 6h14M3 10h14M3 14h14"/>
      </svg>
    </button>
  </div>

  <%# === Mobile menu === %>
  <div id="navbar-mobile-menu" data-navbar-target="menu"
       class="hidden md:hidden bg-card border-b border-lr px-[clamp(1.5rem,5vw,4rem)] pb-5 pt-2">
    <div class="flex flex-col gap-3">
      <a href="#features" data-action="navbar#closeMenu"
         class="font-sans text-[0.88rem] font-medium text-sub hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors py-1">
        <%= t("nav.features") %>
      </a>
      <a href="#how-it-works" data-action="navbar#closeMenu"
         class="font-sans text-[0.88rem] font-medium text-sub hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors py-1">
        <%= t("nav.how_it_works") %>
      </a>

      <% if current_user %>
        <%= link_to t("nav.dashboard"), dashboard_path,
            data: { action: "navbar#closeMenu" },
            class: "font-sans text-[0.88rem] font-medium text-sub hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors py-1" %>
      <% else %>
        <%= link_to t("nav.sign_in"), core.sign_in_path,
            data: { action: "navbar#closeMenu" },
            class: "font-sans text-[0.88rem] font-medium text-sub hover:text-txt focus-visible:text-txt focus-visible:outline-none focus-visible:underline transition-colors py-1" %>
      <% end %>

      <div class="py-1">
        <%= render "shared/locale_toggle" %>
      </div>

      <div class="pt-2">
        <% if current_user %>
          <%= link_to t("nav.profile"), profile_path,
              class: "inline-flex items-center justify-center font-sans text-[0.85rem] font-semibold
                      bg-accent text-accent-text px-5 py-2.5 rounded-btn btn-shadow w-full" %>
        <% else %>
          <%= link_to t("nav.sign_up"), core.sign_up_path,
              class: "inline-flex items-center justify-center font-sans text-[0.85rem] font-semibold
                      bg-accent text-accent-text px-5 py-2.5 rounded-btn btn-shadow w-full" %>
        <% end %>
      </div>
    </div>
  </div>
</nav>
