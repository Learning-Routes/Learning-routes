<% content_for(:title) { t("wizard.title") } %>
<% content_for(:hide_navbar) { true } %>
<% content_for(:head) do %>
  <style>
    @media (min-width: 480px) {
      .wizard-topic-grid { grid-template-columns: repeat(3, 1fr) !important; }
    }
  </style>
<% end %>



<%
  wizard_i18n = {
    step_label: t("wizard.step_label", n: ":n"),
    step_of: t("wizard.step_of"),
    step_names: [
      t("wizard.step0.step_name"),
      t("wizard.step1.step_name"),
      t("wizard.step2.step_name"),
      t("wizard.step3.step_name"),
      t("wizard.step4.step_name")
    ],
    continue_text: t("wizard.continue"),
    generate_text: t("wizard.generate"),
    back_text: t("wizard.back"),
    progress_of_6: t("wizard.step3.progress", done: ":done"),
    topics: {
      "programming" => "ðŸ’» " + t("wizard.step0.topics.programming"),
      "languages" => "ðŸŒ " + t("wizard.step0.topics.languages"),
      "math" => "ðŸ“ " + t("wizard.step0.topics.math"),
      "science" => "ðŸ”¬ " + t("wizard.step0.topics.science"),
      "business" => "ðŸ“Š " + t("wizard.step0.topics.business"),
      "arts" => "ðŸŽ¨ " + t("wizard.step0.topics.arts")
    },
    levels: {
      "beginner" => "ðŸŒ± " + t("wizard.step1.levels.beginner"),
      "basic" => "ðŸŒ¿ " + t("wizard.step1.levels.basic"),
      "intermediate" => "ðŸŒ³ " + t("wizard.step1.levels.intermediate"),
      "advanced" => "ðŸ”ï¸ " + t("wizard.step1.levels.advanced")
    },
    styles: {
      "visual" => { "emoji" => "ðŸŽ¬", "name" => t("wizard.styles.visual"), "desc" => t("wizard.styles.visual_desc") },
      "auditory" => { "emoji" => "ðŸŽ§", "name" => t("wizard.styles.auditory"), "desc" => t("wizard.styles.auditory_desc") },
      "reading" => { "emoji" => "ðŸ“–", "name" => t("wizard.styles.reading"), "desc" => t("wizard.styles.reading_desc") },
      "kinesthetic" => { "emoji" => "ðŸ”§", "name" => t("wizard.styles.kinesthetic"), "desc" => t("wizard.styles.kinesthetic_desc") },
      "multimodal" => { "emoji" => "ðŸ§©", "name" => t("wizard.styles.multimodal"), "desc" => t("wizard.styles.multimodal_desc") }
    }
  }
%>

<div id="wizard-container"
     data-controller="route-wizard"
     data-route-wizard-generating-value="<%= @generating %>"
     data-route-wizard-i18n-value="<%= wizard_i18n.to_json %>"
     style="min-height:100vh; display:flex; flex-direction:column;">

  <%# === Mini wizard nav === %>
  <nav style="padding:14px 32px; display:flex; justify-content:space-between; align-items:center; position:relative; z-index:10;">
    <div data-route-wizard-target="navLeft" style="display:flex; align-items:center; gap:10px; cursor:pointer;">
      <a href="<%= profile_path %>" style="display:flex; align-items:center; gap:10px; text-decoration:none; color:#1C1812;">
        <%= render "shared/logo", size: 26 %>
        <span style="font-family:'DM Sans',sans-serif; font-weight:700; font-size:0.9rem; letter-spacing:-0.5px; color:#1C1812;">Learning Routes</span>
      </a>
    </div>
    <a href="<%= profile_path %>" style="font-family:'DM Sans',sans-serif; font-size:0.72rem; color:#9E9587; text-decoration:none; cursor:pointer;"><%= t("wizard.save_and_exit") %></a>
  </nav>

  <%# === Content area === %>
  <div style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:20px 24px 60px; position:relative; z-index:1;">
    <% if @generating %>
      <%= render "route_wizard/generating", route_request: @route_request %>
    <% else %>
      <%= render "route_wizard/wizard_card", route_request: @route_request %>
    <% end %>
  </div>
</div>
