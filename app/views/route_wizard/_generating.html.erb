<%= turbo_stream_from "route_request_#{route_request.id}" %>

<div id="generating-state"
     data-controller="route-generating"
     data-route-generating-url-value="<%= route_wizard_status_path(route_request) %>"
     data-route-generating-request-id-value="<%= route_request.id %>"
     style="display:flex; flex-direction:column; align-items:center; justify-content:center; padding:60px 0; gap:28px;">

  <%# === Animated route ring === %>
  <div style="position:relative; width:120px; height:120px;">
    <svg width="120" height="120" viewBox="0 0 120 120" style="overflow:visible;" fill="none">
      <defs>
        <linearGradient id="gen-grad" x1="0" y1="1" x2="1" y2="0">
          <stop offset="0%" stop-color="#8B80C4"/>
          <stop offset="50%" stop-color="#6E9BC8"/>
          <stop offset="100%" stop-color="#5BA880"/>
        </linearGradient>
      </defs>
      <circle cx="60" cy="60" r="48" stroke="rgba(28,24,18,0.04)" stroke-width="1.5" fill="none"/>
      <circle cx="60" cy="60" r="48" stroke="url(#gen-grad)" stroke-width="2.5" fill="none"
              stroke-dasharray="80 220" stroke-linecap="round" opacity="0.6">
        <animateTransform attributeName="transform" type="rotate" values="0 60 60;360 60 60" dur="1.8s" repeatCount="indefinite"/>
      </circle>
      <%# Inner pulse %>
      <circle cx="60" cy="60" r="20" stroke="#5BA880" stroke-width="1" fill="none" opacity="0.15">
        <animate attributeName="r" values="20;30;20" dur="2s" repeatCount="indefinite"/>
        <animate attributeName="opacity" values="0.2;0.05;0.2" dur="2s" repeatCount="indefinite"/>
      </circle>
      <%# Center dot %>
      <circle cx="60" cy="60" r="6" fill="#5BA880" opacity="0.4"/>
    </svg>
  </div>

  <%# === Text === %>
  <div style="text-align:center;">
    <div style="font-family:'DM Sans',sans-serif; font-weight:700; font-size:1.3rem; color:#1C1812; margin-bottom:8px; letter-spacing:-0.3px;">
      <%= t("wizard.generating.title") %><span data-route-generating-target="dotsText"></span>
    </div>
    <div style="font-family:'DM Sans',sans-serif; font-weight:400; font-size:0.78rem; color:#9E9587; max-width:300px; line-height:1.5;">
      <%= t("wizard.generating.desc") %>
    </div>
  </div>
</div>
